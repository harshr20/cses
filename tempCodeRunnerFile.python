from collections import defaultdict

def countEqualOccurrenceSubarrays(arr):
    count = 0
    prefixSum = 0
    prefixDict = defaultdict(int)
    prefixDict[0] = 1

    for num in arr:
        prefixSum += 1 if num == 1 else -1
        count += prefixDict[prefixSum]
        prefixDict[prefixSum] += 1

        # Include single element subarrays as well
        count += prefixDict[prefixSum - 1]

    return count

arr = [1,2,3]
print(countEqualOccurrenceSubarrays(arr))